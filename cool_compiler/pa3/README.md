## 分析

bison 语法中 结构和  flex 类似 实现代码的逻辑结构

### 语法结构

```c#
%{
声明
%}
定义
%%
制作
%%
用户子程序
```

Pa3 我们需要编辑 cool.y 实现对 语法	结构的分析， 并且保证语法的逻辑正确，**先乘除法后加减法**。

利用的 LR(1) 的语法分析结构

`expr: id | id '+' id;`  如这样去匹配 +号

%token 用于标记语法解析中用到的基本语素  总结字符

规则部分写自己定义规则

%left     左推导   后定义的优先级更高 所以我们定义 加减乘除的时候要 先定义加减 后定义乘除

```c#
%left '+' '-'
%left '*' '/'
```



实现对应的语义分析

Cool.y 里面的内容和函数实现，要根据

`cool-tree.h` 来找到对应的函数。来进行语义的分析，里面保存的是对应运算的函数。

通过编译原理的 语义分析公式 对cool 语法进行分析。



例如：

语义分析 两数相加

在 `cool-tree.h` 中 这样定义功能

```c++
Expression plus(Expression e1, Expression e2)
{
  return new plus_class(e1, e2);
}
```

我们在`cool.y` 中就要写为. 匹配 $1 $3 作为参数 传给 plus 函数。然后返回给 $$

```c#
expr '+' expr 
{ $$ = plus($1, $3); }
```



注意⚠️ 

除了我们需要的功能，我们自己还要写 不同类语义分析对应的 `error`

还要去 匹配到 ';' 保存语法的完整性